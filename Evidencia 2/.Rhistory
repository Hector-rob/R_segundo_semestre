listaCov2= c("ss","DNA","positivo")
listaSars = c("ss","DNA","positivo")
listaMers = c("ss","DNA","positivo")
listaDengue = c("ss","DNA","positivo")
listaInfluenza = c("ss","DNA","positivo")
listaZika= c("ss","DNA","positivo")
Baltimore <- function(secuencia){
if(secuencia[1] =="ds"){
if(secuencia[2] == "DNA"){
print("Familia 1")
}
}
else if(secuencia[1] == "ss"){
if(secuencia[2] == "DNA"){
if(secuencia[3] == "positivo"){
print("Familia 2")
}
}
}
else if(secuencia[1] == "ds"){
if(secuencia[2] == "RNA"){
print("Familia 3")
}
}
else if(secuencia[1] == "ss"){
if(secuencia[2] == "RNA"){
if(secuencia[3] == "positivo")
print("Familia 4")
}
}
}
else if(secuencia[1] == "ss"){
msaplot(p=ggtree(virus_plot) +geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",width = 1, window=c(10,20), offset = 0.015,height = 0.5)
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta")
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",windoW = c(10,20))
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",window = c(10,20))
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",window = c(10,200))
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",window = c(20,200))
msaplot(p=ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)),
fasta="virus_align_seq.fasta",window = c(1000,1000))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot), fasta="virus_align_seq.fasta", window=c(150, 200)) + coord_polar(theta='y')
msaplot(p=ggtree(virus_plot)  %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta", window=c(150, 200)) + coord_polar(theta='y')
dfViruses <- data.frame(id = ids, pais = paises)
dfViruses
msaplot(p=ggtree(virus_plot)  %<+% dfViruses + geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta", window=c(150, 200)) + coord_polar(theta='y')
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta", window=c(150, 200))
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta", window=c(150, 200, width = 1, offset = 0.015,height = 0.5))
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(10, 20), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 1, height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 0.015, height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(150, 200), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(150, 200), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(1, 360), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(1, 360), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(1, 200), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 2, window=c(1, 150), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(1, 150), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(100, 250), offset = 0.015, height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(1, 50), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta",width = 1, window=c(150, 200), offset = 0.015, height = 0.6)
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "Dark green", "g" = "blue", "t"=    "yellow"))
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
setwd("~/Desktop/Evidencia 2")
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("adenina" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
df <- read.csv("Evidencia02.csv", header = TRUE)
df
EUA <- read.GenBank(df[1,2],as.character = TRUE)
Brasil <- read.GenBank(df[2,2],as.character = TRUE)
Mexico <-read.GenBank(df[3,2],as.character = TRUE)
India <-read.GenBank(df[4,2],as.character = TRUE)
UK <-read.GenBank(df[5,2],as.character = TRUE)
Italia <-read.GenBank(df[6,2],as.character = TRUE)
Rusia <-read.GenBank(df[7,2],as.character = TRUE)
Francia <-read.GenBank(df[8,2],as.character = TRUE)
Alemania <-read.GenBank(df[9,2],as.character = TRUE)
Espana <- read.GenBank(df[10,2],as.character = TRUE)
Colombia <- read.GenBank(df[11,2],as.character = TRUE)
Iran <- read.GenBank(df[12,2],as.character = TRUE)
Polonia <- read.GenBank(df[13,2],as.character = TRUE)
Argentina <- read.GenBank(df[14,2],as.character = TRUE)
Peru <- read.GenBank(df[15,2],as.character = TRUE)
Sudafrica <- read.GenBank(df[16,2],as.character = TRUE)
Indonesia <- read.GenBank(df[17,2],as.character = TRUE)
RepCheca <- read.GenBank(df[18,2],as.character = TRUE)
Turquia <- read.GenBank(df[19,2],as.character = TRUE)
Romania <- read.GenBank(df[20,2],as.character = TRUE)
dftUSA <- as.data.frame(count(EUA$MW965797, wordsize = 1))
dftBrasil <- as.data.frame(count(Brasil$MT925972, wordsize = 1))
dftUSA <- as.data.frame(count(EUA$MW965797, wordsize = 1))
dftBrasil <- as.data.frame(count(Brasil$MW592707, wordsize = 1))
dftMexico <- as.data.frame(count(Mexico$MW884219, wordsize = 1))
dftIndia <- as.data.frame(count(India$MW927136, wordsize = 1))
dftReinoU <- as.data.frame(count(UK$OA976392, wordsize = 1))
dftItalia <- as.data.frame(count(Italia$MW852494, wordsize = 1))
dftRusia <- as.data.frame(count(Rusia$MW741552, wordsize = 1))
dftFrancia <- as.data.frame(count(Francia$LR881474, wordsize = 1))
dftAlemania <- as.data.frame(count(Alemania$MW822592, wordsize = 1))
dftEspana <- as.data.frame(count(Espana$MW976780, wordsize = 1))
dftColombia <- as.data.frame(count(Colombia$MT470219, wordsize = 1))
dftIran <- as.data.frame(count(Iran$MW898809, wordsize = 1))
dftPolonia <- as.data.frame(count(Polonia$HG994158, wordsize = 1))
dftArgentina <- as.data.frame(count(Argentina$MW633891, wordsize = 1))
dftPeru <- as.data.frame(count(Peru$MW938089, wordsize = 1))
dftSudafrica <- as.data.frame(count(Sudafrica$MW981442, wordsize = 1))
dftIndonesia <- as.data.frame(count(Indonesia$MZ026853, wordsize = 1))
dftRepCheca <- as.data.frame(count(RepCheca$MT534285, wordsize = 1))
dftTurquia <- as.data.frame(count(Turquia$MW308549, wordsize = 1))
dftRomania <- as.data.frame(count(Romania$MW255830, wordsize = 1))
longitud = function(dataframe){
tamanio <- 0
for (i in 1:4){
tamanio <- dataframe[i,2] + tamanio
}
return(tamanio)
}
cat("Tamaño de la secuencia de COVID de USA:",longitud(dftUSA),"\n")
cat("Tamaño de la secuencia de COVID de Brasil :",longitud(dftBrasil),"\n")
cat("Tamaño de la secuencia de COVID de Mexico:",longitud(dftMexico),"\n")
cat("Tamaño de la secuencia de COVID de India:",longitud(dftIndia),"\n")
cat("Tamaño de la secuencia de COVID de Reino Unido:",longitud(dftReinoU),"\n")
cat("Tamaño de la secuencia de COVID de Italia:",longitud(dftItalia),"\n")
cat("Tamaño de la secuencia de COVID de Rusia:",longitud(dftRusia),"\n")
cat("Tamaño de la secuencia de COVID de Francia:",longitud(dftFrancia),"\n")
cat("Tamaño de la secuencia de COVID de Alemania:",longitud(dftAlemania),"\n")
cat("Tamaño de la secuencia de COVID de España:",longitud(dftEspana),"\n")
cat("Tamaño de la secuencia de COVID de Colombia:",longitud(dftColombia),"\n")
cat("Tamaño de la secuencia de COVID de Irán:",longitud(dftIran),"\n")
cat("Tamaño de la secuencia de COVID de Polonia:",longitud(dftPolonia),"\n")
cat("Tamaño de la secuencia de COVID de Argentina:",longitud(dftArgentina),"\n")
cat("Tamaño de la secuencia de COVID de Perú:",longitud(dftPeru),"\n")
cat("Tamaño de la secuencia de COVID de Sudáfrica:",longitud(dftSudafrica),"\n")
cat("Tamaño de la secuencia de COVID de Indonesia:",longitud(dftIndonesia),"\n")
cat("Tamaño de la secuencia de COVID de República Checa:",longitud(dftRepCheca),"\n")
cat("Tamaño de la secuencia de COVID de Turquía:",longitud(dftTurquia),"\n")
cat("Tamaño de la secuencia de COVID de Romania:",longitud(dftRomania),"\n")
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
dftodas <- read.csv("Evidencia02.csv" ,header = TRUE)
dftodas
ids <- c()
paises <-c()
for (i in 1:20){
ids <- append(ids,dftodas[i,2])
paises <- append(paises,dftodas[i,1])
}
paises
ids
dfViruses <- data.frame(id = ids, pais = paises)
dfViruses
virus_secuencias <- read.GenBank(dfViruses[,1])
virus_secuencias
str(virus_secuencias)
write.dna(virus_secuencias,
file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = "", colw = 40)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_seq_alineadas <- AlignSeqs(virus_seq_no_alineadas)
BrowseSeqs(virus_seq_alineadas, highlight = 0)
writeXStringSet(virus_seq_alineadas, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
matriz_distancias <- dist.alignment(virus_aligned, matrix = "similarity")
matriz_distancias
virus_str_filogenetico <- njs(matriz_distancias)
virus_str_filogenetico
class(virus_str_filogenetico)
ggtree(virus_plot) + geom_tiplab()
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
writeXStringSet(virus_seq_alineadas, file = "virus_align_seq.fasta2")
virus_aligned <- read.alignment("virus_align_seq.fasta2", format = "fasta")
matriz_distancias <- dist.alignment(virus_aligned, matrix = "similarity")
matriz_distancias
virus_str_filogenetico <- njs(matriz_distancias)
virus_str_filogenetico
class(virus_str_filogenetico)
ggtree(virus_plot) + geom_tiplab()
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta2",width = 1, window=c(150, 200), offset = 0.015, height = 0.6)
writeXStringSet(virus_seq_alineadas, file = "virus_align_seq.fasta2")
virus_aligned <- read.alignment("virus_align_seq.fasta2", format = "fasta")
matriz_distancias <- dist.alignment(virus_aligned, matrix = "similarity")
matriz_distancias
virus_str_filogenetico <- njs(matriz_distancias)
virus_str_filogenetico
class(virus_str_filogenetico)
write.dna(virus_secuencias,
file ="virus_seqs.fasta2", format = "fasta", append =
FALSE, nbcol = 6, colsep = "", colw = 40)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta2", format = "fasta")
virus_seq_no_alineadas
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_seq_alineadas <- AlignSeqs(virus_seq_no_alineadas)
BrowseSeqs(virus_seq_alineadas, highlight = 0)
writeXStringSet(virus_seq_alineadas, file = "virus_align_seq.fasta2")
virus_aligned <- read.alignment("virus_align_seq.fasta2", format = "fasta")
matriz_distancias <- dist.alignment(virus_aligned, matrix = "similarity")
matriz_distancias
virus_str_filogenetico <- njs(matriz_distancias)
virus_str_filogenetico
class(virus_str_filogenetico)
virus_plot <- ladderize(virus_str_filogenetico)
plot(virus_plot)
title("SARS_COV2")
ggtree(virus_plot) + geom_tiplab()
ggtree(virus_plot) %<+% dfViruses + xlim(NA,20) + geom_tiplab(aes(label=pais))
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta2",width = 1, window=c(150, 200), offset = 0.015, height = 0.6)
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
citation("Biostrings")
citation("seqinr")
citation("adegenet")
citation("ape")
citation("ggtree")
citation("DECIPHER")
citation("viridis")
citation("ggplot2")
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
library(Biostrings)
library(seqinr)
library(adegenet)
library(ape)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
df <- read.csv("Evidencia02.csv", header = TRUE)
df
EUA <- read.GenBank(df[1,2],as.character = TRUE)
Brasil <- read.GenBank(df[2,2],as.character = TRUE)
Mexico <-read.GenBank(df[3,2],as.character = TRUE)
India <-read.GenBank(df[4,2],as.character = TRUE)
UK <-read.GenBank(df[5,2],as.character = TRUE)
Italia <-read.GenBank(df[6,2],as.character = TRUE)
Rusia <-read.GenBank(df[7,2],as.character = TRUE)
Francia <-read.GenBank(df[8,2],as.character = TRUE)
Alemania <-read.GenBank(df[9,2],as.character = TRUE)
Espana <- read.GenBank(df[10,2],as.character = TRUE)
Colombia <- read.GenBank(df[11,2],as.character = TRUE)
Iran <- read.GenBank(df[12,2],as.character = TRUE)
Polonia <- read.GenBank(df[13,2],as.character = TRUE)
Argentina <- read.GenBank(df[14,2],as.character = TRUE)
Peru <- read.GenBank(df[15,2],as.character = TRUE)
Sudafrica <- read.GenBank(df[16,2],as.character = TRUE)
Indonesia <- read.GenBank(df[17,2],as.character = TRUE)
RepCheca <- read.GenBank(df[18,2],as.character = TRUE)
Turquia <- read.GenBank(df[19,2],as.character = TRUE)
Romania <- read.GenBank(df[20,2],as.character = TRUE)
dftUSA <- as.data.frame(count(EUA$MW965797, wordsize = 1))
dftBrasil <- as.data.frame(count(Brasil$MW592707, wordsize = 1))
dftMexico <- as.data.frame(count(Mexico$MW884219, wordsize = 1))
dftIndia <- as.data.frame(count(India$MW927136, wordsize = 1))
dftReinoU <- as.data.frame(count(UK$OA976392, wordsize = 1))
dftItalia <- as.data.frame(count(Italia$MW852494, wordsize = 1))
dftRusia <- as.data.frame(count(Rusia$MW741552, wordsize = 1))
dftFrancia <- as.data.frame(count(Francia$LR881474, wordsize = 1))
dftAlemania <- as.data.frame(count(Alemania$MW822592, wordsize = 1))
dftEspana <- as.data.frame(count(Espana$MW976780, wordsize = 1))
dftColombia <- as.data.frame(count(Colombia$MT470219, wordsize = 1))
dftIran <- as.data.frame(count(Iran$MW898809, wordsize = 1))
dftPolonia <- as.data.frame(count(Polonia$HG994158, wordsize = 1))
dftArgentina <- as.data.frame(count(Argentina$MW633891, wordsize = 1))
dftPeru <- as.data.frame(count(Peru$MW938089, wordsize = 1))
dftSudafrica <- as.data.frame(count(Sudafrica$MW981442, wordsize = 1))
dftIndonesia <- as.data.frame(count(Indonesia$MZ026853, wordsize = 1))
dftRepCheca <- as.data.frame(count(RepCheca$MT534285, wordsize = 1))
dftTurquia <- as.data.frame(count(Turquia$MW308549, wordsize = 1))
dftRomania <- as.data.frame(count(Romania$MW255830, wordsize = 1))
longitud = function(dataframe){
tamanio <- 0
for (i in 1:4){
tamanio <- dataframe[i,2] + tamanio
}
return(tamanio)
}
cat("Tamaño de la secuencia de COVID de USA:",longitud(dftUSA),"\n")
cat("Tamaño de la secuencia de COVID de Brasil :",longitud(dftBrasil),"\n")
cat("Tamaño de la secuencia de COVID de Mexico:",longitud(dftMexico),"\n")
cat("Tamaño de la secuencia de COVID de India:",longitud(dftIndia),"\n")
cat("Tamaño de la secuencia de COVID de Reino Unido:",longitud(dftReinoU),"\n")
cat("Tamaño de la secuencia de COVID de Italia:",longitud(dftItalia),"\n")
cat("Tamaño de la secuencia de COVID de Rusia:",longitud(dftRusia),"\n")
cat("Tamaño de la secuencia de COVID de Francia:",longitud(dftFrancia),"\n")
cat("Tamaño de la secuencia de COVID de Alemania:",longitud(dftAlemania),"\n")
cat("Tamaño de la secuencia de COVID de España:",longitud(dftEspana),"\n")
cat("Tamaño de la secuencia de COVID de Colombia:",longitud(dftColombia),"\n")
cat("Tamaño de la secuencia de COVID de Irán:",longitud(dftIran),"\n")
cat("Tamaño de la secuencia de COVID de Polonia:",longitud(dftPolonia),"\n")
cat("Tamaño de la secuencia de COVID de Argentina:",longitud(dftArgentina),"\n")
cat("Tamaño de la secuencia de COVID de Perú:",longitud(dftPeru),"\n")
cat("Tamaño de la secuencia de COVID de Sudáfrica:",longitud(dftSudafrica),"\n")
cat("Tamaño de la secuencia de COVID de Indonesia:",longitud(dftIndonesia),"\n")
cat("Tamaño de la secuencia de COVID de República Checa:",longitud(dftRepCheca),"\n")
cat("Tamaño de la secuencia de COVID de Turquía:",longitud(dftTurquia),"\n")
cat("Tamaño de la secuencia de COVID de Romania:",longitud(dftRomania),"\n")
Nucleotidos <- read.csv("Nucleotidos.csv")
dfuno <- as.data.frame(Nucleotidos[1:20,])
dfdos <- as.data.frame(Nucleotidos[21:40,])
dftres <- as.data.frame(Nucleotidos[41:60,])
dfcuatro <- as.data.frame(Nucleotidos[61:80,])
ggplot(data = dfuno, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfdos, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dftres, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
ggplot(data = dfcuatro, aes(x=Pais,y=Cantidad,fill=Nucleotido))+geom_bar(stat="identity")+scale_fill_manual(values = c("a" = "red", "c" = "green", "g" = "blue", "t"=    "yellow"))
dftodas <- read.csv("Evidencia02.csv" ,header = TRUE)
dftodas
ids <- c()
paises <-c()
for (i in 1:20){
ids <- append(ids,dftodas[i,2])
paises <- append(paises,dftodas[i,1])
}
paises
ids
dftodas <- read.csv("Evidencia02.csv" ,header = TRUE)
dftodas
ids <- c()
paises <-c()
for (i in 1:20){
ids <- append(ids,dftodas[i,2])
paises <- append(paises,dftodas[i,1])
}
dfViruses <- data.frame(id = ids, pais = paises)
dfViruses
virus_secuencias <- read.GenBank(dfViruses[,1])
virus_secuencias
str(virus_secuencias)
write.dna(virus_secuencias,
file ="virus_seqs.fasta2", format = "fasta", append =
FALSE, nbcol = 6, colsep = "", colw = 40)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta2", format = "fasta")
virus_seq_no_alineadas
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_seq_alineadas <- AlignSeqs(virus_seq_no_alineadas)
BrowseSeqs(virus_seq_alineadas, highlight = 0)
writeXStringSet(virus_seq_alineadas, file = "virus_align_seq.fasta2")
virus_aligned <- read.alignment("virus_align_seq.fasta2", format = "fasta")
matriz_distancias <- dist.alignment(virus_aligned, matrix = "similarity")
matriz_distancias
virus_str_filogenetico <- njs(matriz_distancias)
virus_str_filogenetico
class(virus_str_filogenetico)
virus_plot <- ladderize(virus_str_filogenetico)
plot(virus_plot)
title("SARS_COV2")
ggtree(virus_plot) + geom_tiplab()
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(500, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta2",width = 1, window=c(150, 200), offset = 0.015, height = 0.6)
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(1, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(200, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(200, 1000), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(150,500), offset = 0.015,height = 0.5)
msaplot(p=ggtree(virus_plot) +geom_tiplab(),
fasta="virus_align_seq.fasta2",width = 1, window=c(150,500), offset = 0.015,height = 0.8)
msaplot(p=ggtree(virus_plot)  %<+% dfViruses+ geom_tiplab(aes(label=pais)), fasta="virus_align_seq.fasta2",width = 1, window=c(150, 200), offset = 0.015, height = 0.8)
ids <- c()
paises <-c()
for (i in 1:20){
ids <- append(ids,df[i,2])
paises <- append(paises,df[i,1])
}
paises
ids
library(Biostrings)
library(seqinr)
library(adegenet)
library(ape)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
df <- read.csv("Evidencia02.csv", header = TRUE)
df
dftUSA <- as.data.frame(count(EUA$MW965797, wordsize = 1))
dftBrasil <- as.data.frame(count(Brasil$MW592707, wordsize = 1))
dftMexico <- as.data.frame(count(Mexico$MW884219, wordsize = 1))
dftIndia <- as.data.frame(count(India$MW927136, wordsize = 1))
dftReinoU <- as.data.frame(count(UK$OA976392, wordsize = 1))
dftItalia <- as.data.frame(count(Italia$MW852494, wordsize = 1))
dftRusia <- as.data.frame(count(Rusia$MW741552, wordsize = 1))
dftFrancia <- as.data.frame(count(Francia$LR881474, wordsize = 1))
dftAlemania <- as.data.frame(count(Alemania$MW822592, wordsize = 1))
dftEspana <- as.data.frame(count(Espana$MW976780, wordsize = 1))
dftColombia <- as.data.frame(count(Colombia$MT470219, wordsize = 1))
dftIran <- as.data.frame(count(Iran$MW898809, wordsize = 1))
dftPolonia <- as.data.frame(count(Polonia$HG994158, wordsize = 1))
dftArgentina <- as.data.frame(count(Argentina$MW633891, wordsize = 1))
dftPeru <- as.data.frame(count(Peru$MW938089, wordsize = 1))
dftSudafrica <- as.data.frame(count(Sudafrica$MW981442, wordsize = 1))
dftIndonesia <- as.data.frame(count(Indonesia$MZ026853, wordsize = 1))
dftRepCheca <- as.data.frame(count(RepCheca$MT534285, wordsize = 1))
dftTurquia <- as.data.frame(count(Turquia$MW308549, wordsize = 1))
dftRomania <- as.data.frame(count(Romania$MW255830, wordsize = 1))
longitud = function(dataframe){
tamanio <- 0
for (i in 1:4){
tamanio <- dataframe[i,2] + tamanio
}
return(tamanio)
}
cat("Tamaño de la secuencia de COVID de USA:",longitud(dftUSA),"\n")
cat("Tamaño de la secuencia de COVID de Brasil :",longitud(dftBrasil),"\n")
cat("Tamaño de la secuencia de COVID de Mexico:",longitud(dftMexico),"\n")
cat("Tamaño de la secuencia de COVID de India:",longitud(dftIndia),"\n")
cat("Tamaño de la secuencia de COVID de Reino Unido:",longitud(dftReinoU),"\n")
cat("Tamaño de la secuencia de COVID de Italia:",longitud(dftItalia),"\n")
cat("Tamaño de la secuencia de COVID de Rusia:",longitud(dftRusia),"\n")
cat("Tamaño de la secuencia de COVID de Francia:",longitud(dftFrancia),"\n")
cat("Tamaño de la secuencia de COVID de Alemania:",longitud(dftAlemania),"\n")
cat("Tamaño de la secuencia de COVID de España:",longitud(dftEspana),"\n")
cat("Tamaño de la secuencia de COVID de Colombia:",longitud(dftColombia),"\n")
cat("Tamaño de la secuencia de COVID de Irán:",longitud(dftIran),"\n")
cat("Tamaño de la secuencia de COVID de Polonia:",longitud(dftPolonia),"\n")
cat("Tamaño de la secuencia de COVID de Argentina:",longitud(dftArgentina),"\n")
cat("Tamaño de la secuencia de COVID de Perú:",longitud(dftPeru),"\n")
cat("Tamaño de la secuencia de COVID de Sudáfrica:",longitud(dftSudafrica),"\n")
cat("Tamaño de la secuencia de COVID de Indonesia:",longitud(dftIndonesia),"\n")
cat("Tamaño de la secuencia de COVID de República Checa:",longitud(dftRepCheca),"\n")
cat("Tamaño de la secuencia de COVID de Turquía:",longitud(dftTurquia),"\n")
cat("Tamaño de la secuencia de COVID de Romania:",longitud(dftRomania),"\n")
